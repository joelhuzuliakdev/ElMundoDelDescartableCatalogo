---
import { categories } from '../data/products.js';
---

<nav class="bg-white shadow-md sticky top-0 z-40 no-print transition-transform duration-300" id="category-nav">
    <div class="container mx-auto px-4">
        <div class="flex items-center justify-between py-4">
        <h2 class="text-lg font-semibold text-slate-800">Categor√≠as</h2>
        <button 
            id="menu-toggle" 
            class="md:hidden p-2 rounded-lg hover:bg-slate-100 transition-colors"
            aria-label="Toggle menu"
        >
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
            </svg>
        </button>
        </div>
        
        <div id="category-menu" class="hidden md:block pb-4">
        <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-2">
            {categories.map(category => (
            <a 
                href={`#${category.id}`}
                class="flex items-center gap-2 px-3 py-2 rounded-lg bg-slate-50 hover:bg-slate-100 transition-colors text-sm font-medium text-slate-700 hover:text-slate-900"
            >
                <span class="truncate">{category.name}</span>
            </a>
            ))}
        </div>
        </div>
    </div>
</nav>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const menuToggle = document.getElementById('menu-toggle');
        const categoryMenu = document.getElementById('category-menu');
        const categoryNav = document.getElementById('category-nav');
        const header = document.getElementById('main-header');
        let lastScroll = 0;
        
        menuToggle?.addEventListener('click', () => {
        categoryMenu?.classList.toggle('hidden');
        });

        // Handle scroll for both header and category nav
        window.addEventListener('scroll', () => {
        const currentScroll = window.pageYOffset;
        
        if (currentScroll <= 0) {
            header?.classList.remove('-translate-y-full');
            categoryNav?.classList.remove('-translate-y-full');
            return;
        }
        
        if (currentScroll > lastScroll && currentScroll > 100) {
            // Scrolling down - hide both
            header?.classList.add('-translate-y-full');
            categoryNav?.classList.add('-translate-y-full');
        } else {
            // Scrolling up - show both
            header?.classList.remove('-translate-y-full');
            categoryNav?.classList.remove('-translate-y-full');
        }
        
        lastScroll = currentScroll;
        });

        // Smooth scroll with offset
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', (e) => {
            e.preventDefault();
            const target = document.querySelector(anchor.getAttribute('href'));
            if (target) {
            // Show header and nav when clicking
            header?.classList.remove('-translate-y-full');
            categoryNav?.classList.remove('-translate-y-full');
            
            const headerHeight = header?.offsetHeight || 0;
            const navHeight = categoryNav?.offsetHeight || 0;
            const offset = headerHeight + navHeight + 20;
            const targetPosition = target.offsetTop - offset;
            
            window.scrollTo({
                top: targetPosition,
                behavior: 'smooth'
            });
            // Close mobile menu
            categoryMenu?.classList.add('hidden');
            }
        });
        });
  });
</script>